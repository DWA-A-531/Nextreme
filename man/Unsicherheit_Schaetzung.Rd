% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Unsicherheit_Schaetzung.R
\name{Unsicherheit_Schaetzung}
\alias{Unsicherheit_Schaetzung}
\title{Schaetzung der Stichprobenunsicherheit durch Bootstrapping.}
\usage{
Unsicherheit_Schaetzung(
  Serie,
  Tn = c(2, 5, 10, 20, 50, 100),
  Dauern = c(5, 10, 15, 30, 60, 120, 360, 720, 1440, 2880, 4320, 10080),
  methGEV = "GEV",
  formTyp = "FIX",
  Gamma = -0.1,
  nBoots = 100,
  rSeed = 1232,
  SerieTyp = "DDF",
  Konfidenzgrenzen = c(0.05, 0.95)
)
}
\arguments{
\item{Serie}{Jaehrliche Maximum Serien (als Regenintensitaet in mm/h) werden als Tabelle (data.frame Format), wo die Anzahl der Zeilen die Jahre mit verfuegbaren Daten und die Anzahl der Spalten die ausgewaehlten Regendauern bezeichnen.}

\item{Tn}{die Wiederkehrintervalle, fuer die die Regenhoehe/Intensitaet berechnet werden sollen. Die Wiederkehrintervalle sollten in Jahren angegeben werden!}

\item{Dauern}{Regendauern, die fuer die Berechnung der Jaehrliche Maximum Serien verwendet sind. Die gleiche Einheit (entweder Minuten oder Stunden) wie das Intervall. Standartwerte sind: 5, 10, 15,30,60,120,360,720,1440, 2880, 4320 und 10080min.}

\item{methGEV}{den Typ der Generalized Extreme Value-Verteilung, die an die jaehrlichen Serien angepasst werden soll. Optionen sind: "GEV" fuer Typ 2 oder Typ 3 (Form-Parameter ist nicht gleich Null) und "GUM" fuer Typ 1 (Form-Parameter ist gleich Null – Gumbel Verteilung)}

\item{formTyp}{kontrolliert, wie der Formparameter der Generalized Extreme Value Distribution (nur bei methGEV=„GEV“) geschaetzt werden soll. Die Option „CON“ berechnet die Formparameter auf der Basis der L-Momente, und die Option „FIX“ erzwingt einen bestimmten Wert fuer den Formparameter (zum Beispiel -0,1).}

\item{Gamma}{den vorbestimmten Wert des GEV-Form-Parameters angeben. Nur wichtig fuer die Variante von methGEV=„GEV“ und formTyp=„FIX“.}

\item{nBoots}{die Anzahl der zufaelligen Realisierungen, die aus den jaehrlichen Serien zu ziehen sind.}

\item{rSeed}{Random Seed fuer das Bootstrapping und die Realisationen, um die gleiche Ausgabe fuer jede gleiche Eingabe zu garantieren.}

\item{SerieTyp}{Kontrolle ueber die Einheiten der Ausgabetabelle. Die Optionen sind: "DDF" fuer Regenhoehe in mm, und "IDF" fuer Regenintensitaet in mm/h.}

\item{Konfidenzgrenzen}{Perzentile der nBoots-Realisierungen, die die Funktion zurueckbringen soll. Das Format sollte Vektor sein, wobei der erste Wert fuer die untere Konfidenzgrenze und der zweite Wert fuer die obere Konfidenzgrenze steht.}
}
\value{
Ein List  der die erhaltenen nBoots-Realisierungen fuer die Quantils (erster Eintrag ~  QUA_INFO) und fuer die Parameter (zweiter Eintrag ~ PAR_INFO) enthaelt.
}
\description{
Die Stichprobenunsicherheit der extremen Niederschlagsparameter und der erforderlichen Quantils wird auf der Grundlage des Bootstrapping-Algorithmus berechnet, wie in Kapitel 6.3 des DWA-A 531 Merkblattes beschrieben.
1. die Jahre der jaehrlichen Maximum Serien (als Regenintensitaet in mm/h) werden nBoots mal mit Ersetzung neu gesampelt. Die neu gesampelten Jahre werden fuer jede Dauer selektiert und bilden so nBoots neue jaehrliche Serien.
2. fuer jede aehrlichen Maximum Serien (als Regenintensitaet in mm/h) werden die Parameter berechnet. Die Konfidenzgrenzen fuer jeden Parameter werden aus nBoots berechnet.
3. fuer jeden Parametersatz wird die Regenhoehe/-intensitaet fuer die gewuenschten Dauern und Wiederkehrintervalle berechnet, wobei die Konfidenzgrenzen fuer jeden Wert aus nBoots errechnet werden.
}
\details{
Die Unsicherheit wird auf der Basis der Breite der Konfidenzgrenzen geschaetzt, die aus nBoots-Realisierungen fuer einen bestimmten Wert (entweder Parameter oder Quantil) erhalten sind.
Die folgende Formel kann verwendet werden:
}
\examples{
# Beispiel 1
# Berechnung der Stichprobenunsicherheit durch 50 Realisierungen fuer die jaehrlichen Serien in Goerlitz von 1991 bis 2020.
Unsicherheit  = Unsicherheit_Schaetzung(Goerlitz_iN,Tn=100, nBoots =50, rSeed=15, SerieTyp="DDF" )
# aus der Unsicherheit nur die Quantils Information extrahieren
HN_KI  = Unsicherheit$QUA_INFO
dauern = c(5, 10, 15,30,60,120,360,720,1440, 2880, 4320, 10080)
# das geschaetzte Konfidenzintervall fuer 100 Jahre Wiederkehrintervalle und die gegebenen Dauern darstellen.
library(scales)
plot(dauern, HN_KI$Mittelwert["100",], type="l", lwd=2, lty=1, log="xy", ylim=range(HN_KI$`95\%`["100",], HN_KI$`5\%`["100",]), col="royalblue",
    ylab="Hn [mm]", xlab="Dauer [min]", main = "Station Goerlitz")
polygon(c(dauern, rev(dauern)), c(HN_KI$`5\%`["100",], rev(HN_KI$`95\%`["100",])), col=alpha("royalblue",0.5), border=NA)
legend("topleft", c("95\%KI", "Mittelwert"),  col=c(alpha("royalblue",0.5), "royalblue"), lty=c(1, 1), lwd=c(10,2), title = "Legende", bty="n")
# Relative Unsicherheit fuer 100 Jahre Wiederkehrintervalle und die gegebenen Dauern darstellen.
barplot(unlist(HN_KI$rel.Unsicherheit["100",]), ylab=expression('100 x(K'[o]~-~K[u]~')/K'),xlab="Dauern [min]",main="Tn=100Jahre", col = hcl.colors(12, palette = "viridis"))

#  Beispiel 2
# Berechnung der Stichprobenunsicherheit durch 100 Realisierungen fuer die jaehrlichen Serien in Goerlitz von 1991 bis 2020. Wiederkehrintervalle von 20, 50 und 100 Jahren betrachten.
Unsicherheit  = Unsicherheit_Schaetzung(Goerlitz_iN,Tn=c(20,50,100), nBoots =100, rSeed=15, SerieTyp="DDF")
# aus der Unsicherheit nur die Parameterformation extrahieren
PAR_KI  = Unsicherheit$PAR_INFO
print(PAR_KI)
# aus der Unsicherheit nur die Quantils Information extrahieren
hN_KI   = Unsicherheit$QUA_INFO
# Relative Unsicherheit fuer die gegebene Wiederkehrintervalle und Dauern darstellen.
barplot(as.matrix(hN_KI$rel.Unsicherheit), beside=T, ylab=expression('100 x(K'[o]~-~K[u]~')/K'),ylim=c(0,50), xaxt='n', xlab="Dauern [min]",main="Station Goerlitz", col=c("royalblue1","royalblue3", "royalblue4"))
legend("top",legend=rownames(hN_KI$rel.Unsicherheit), fill = c("royalblue1","royalblue3", "royalblue4"), bty="n", title="Ta")
# Alternativ Darstellung
barplot(as.matrix(t(hN_KI$rel.Unsicherheit)), beside=T, ylab=expression('100 x(K'[o]~-~K[u]~')/K'),ylim=c(0,50), xaxt='n',main="Station Goerlitz", col=hcl.colors(12, palette = "viridis"))
axis(1, at = c(7, 20, 34), rownames(hN_KI$rel.Unsicherheit))
legend_order <- matrix(1:12,ncol=6,byrow = TRUE)
legend("top",legend=dauern[legend_order], fill=hcl.colors(12, palette = "viridis")[legend_order],  bty="n",title="Daurn [min]", cex=0.6, ncol=6)
}
